d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
(nrow(d) > 0 & count == 0 )
p0 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
p0
count = count +1
p0 = NULL
count = 0
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
for (j in 1:length(years)) {
d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
for (i in 1:nrow(d)){
if (nrow(d) > 0 & count == 0 ) {
p0 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
count = count +1
reverse_citation = 9999999
}
else {
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
}
if (nrow(d) > 0){
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2), collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
}
}
d0$reverse_citation = reverse_citation
df = rbind(df,d0)
reverse_citation
length(reverse_citation)
dim(d0)
j = 1
p0 = NULL
count = 0
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
for (i in 1:nrow(d)){
if (nrow(d) > 0 & count == 0 ) {
p0 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
count = count +1
reverse_citation = 9999999
}
else {
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
}
if (nrow(d) > 0){
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2), collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
}
reverse_citation
reverse_citation = NULL
reverse_citation
for (i in 1:nrow(d)){
if (nrow(d) > 0 & count == 0 ) {
p0 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
count = count +1
reverse_citation = 9999999
}
else {
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
}
if (nrow(d) > 0){
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2), collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
}
reverse_citation
j = 2
for (i in 1:nrow(d)){
if (nrow(d) > 0 & count == 0 ) {
p0 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
count = count +1
reverse_citation = 9999999
}
else {
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
}
if (nrow(d) > 0){
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2), collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
}
reverse_citation
j = 3
for (i in 1:nrow(d)){
if (nrow(d) > 0 & count == 0 ) {
p0 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
count = count +1
reverse_citation = 9999999
}
else {
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
}
if (nrow(d) > 0){
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2), collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
}
reverse_citation
j = 1
d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
for (i in 1:nrow(d)){
if (nrow(d) > 0 & count == 0 ) {
p0 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
count = count +1
reverse_citation = 9999999
}
else {
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
}
if (nrow(d) > 0){
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2), collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
}
reverse_citation
j = 2
d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
for (i in 1:nrow(d)){
if (nrow(d) > 0 & count == 0 ) {
p0 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
count = count +1
reverse_citation = 9999999
}
else {
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
}
if (nrow(d) > 0){
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2), collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
}
reverse_citation
d
p0
count
pattern = paste(p0,collapse="|")
pattern
i = 1
p0 = NULL
count = 0
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
for (j in 1:length(years)) {
d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
for (i in 1:nrow(d)){
if (nrow(d) > 0 & count == 0 ) {
p0 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
count = count +1
reverse_citation = 9999999
}
else {
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
}
if (nrow(d) > 0){
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2), collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
}
}
d0$reverse_citation = reverse_citation
df = rbind(df,d0)
d0$Reverse.Cites..USC.[1]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
p0
df = data.frame(NULL)
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
for (j in 1:length(years)) {
d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
for (i in 1:nrow(d)){
# if (nrow(d) > 0 & count == 0 ) {
# count = count +1
# reverse_citation = 9999999
#       }
#  else {
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
}
if (nrow(d) > 0){
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2), collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
}
}
d0$reverse_citation = reverse_citation
d0 = data[data$Normalized.Assignee..current. == firm,]
dim(d0)
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
p0
length(years)
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
# for (j in 1:length(years)) {
# d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
for (i in 1:nrow(d0)){
# if (nrow(d) > 0 & count == 0 ) {
# count = count +1
# reverse_citation = 9999999
#       }
#  else {
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
}
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2),
collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
reverse_citation
df = data.frame(NULL)
for (firm in firms){
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
# for (j in 1:length(years)) {
# d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
for (i in 1:nrow(d0)){
# if (nrow(d) > 0 & count == 0 ) {
# count = count +1
# reverse_citation = 9999999
#       }
#  else {
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
}
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2),
collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
d0$reverse_citation = reverse_citation
df = rbind(df,d0)
}
nrow(d0)
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
pattern = paste(p0,collapse="|")
pattern
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
p2
pattern2 = paste0(p2, collapse = "|")
pattern2
p0 = unique(p0,p2)
p0
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2),
collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
reverse_citation
# d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
reverse_citation = NULL
for (i in 1:nrow(d0)){
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2),
collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
reverse_citation
length(reverse_citation)
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
# for (j in 1:length(years)) {
# d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
reverse_citation = NULL
for (i in 1:nrow(d0)){
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2),
collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
d0$reverse_citation = reverse_citation
View(d0)
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
reverse_citation = NULL
i = 1
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
p0
p2
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
p0
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(p0,p2)
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2),
collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
reverse_citation
length(p2)
i = 2
a
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
p2
pattern2 = paste0(p2, collapse = "|")
pattern2
p0 = unique(p0,p2)
p0
p2
p0 = unique(c(p0,p2))
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2),
collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
reverse_citation
firms = unique(data$Normalized.Assignee..current.)
years = unique(data$File.Yr)[order(unique(data$File.Yr))]
data = data[order(data$Normalized.Assignee..current., data$File.Yr, decreasing = F),]
df = data.frame(NULL)
for (firm in firms){
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
# for (j in 1:length(years)) {
# d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
reverse_citation = NULL
for (i in 1:nrow(d0)){
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(c(p0,p2))
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2),
collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
d0$reverse_citation = reverse_citation
df = rbind(df,d0)
}
View(d0)
View(df)
firms = unique(data$Normalized.Assignee..current.)
years = unique(data$File.Yr)[order(unique(data$File.Yr))]
data = data[order(data$Normalized.Assignee..current., data$File.Yr, decreasing = F),]
df = data.frame(NULL)
for (firm in firms){
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
# for (j in 1:length(years)) {
# d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
reverse_citation = NULL
for (i in 1:nrow(d0)){
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(c(p0,p2))
reverse_citation = c(reverse_citation,length(strapplyc(paste(gsub("\\(|\\)","_",pattern2),
collapse = " ")
,pattern = gsub("\\(|\\)","_",pattern))[[1]]))
}
d0$reverse_citation = reverse_citation
df = rbind(df,d0)
}
}
i
j
p2
p0
dim(d0)
p0
p2
which(p2 %in% p0)
p2
p0
which(p0 %in% p2)
df = data.frame(NULL)
for (firm in firms){
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
# for (j in 1:length(years)) {
# d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
reverse_citation = NULL
for (i in 1:nrow(d0)){
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(c(p0,p2))
reverse_citation = c(reverse_citation,length(which(p2 %in% p0)))
}
d0$reverse_citation = reverse_citation
df = rbind(df,d0)
}
View(df)
firm = firms[1]
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
i = 1
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
reverse_citation = NULL
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(c(p0,p2))
reverse_citation = c(reverse_citation,length(which(p2 %in% p0)))
reverse_citation
p2
p0
i = 6
firm = firms[1]
firm
firm = firms[6]
firm
firm = firms[7]
firm
reverse_citation = NULL
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
reverse_citation = NULL
i = 1
pattern = paste(p0,collapse="|")
p2 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[i], collapse = ";"),";")[[1]]))
pattern2 = paste0(p2, collapse = "|")
p0 = unique(c(p0,p2))
p0
p2
reverse_citation = c(reverse_citation,length(which(p2 %in% p0)))
reverse_citation
which(p2 %in% p0)
i = 2
d0$Reverse.Cites..USC.[i]
strsplit(d0$Reverse.Cites..USC.[i],";")
p2 = unique(gsub("\\s+","",strsplit(d0$Reverse.Cites..USC.[i],";")[[1]]))
p2
p0
p0 = unique(c(p0,p2))
p0
reverse_citation = c(reverse_citation,length(which(p2 %in% p0)))
reverse_citation
i = 1
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
# for (j in 1:length(years)) {
# d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
reverse_citation = NULL
for (i in 1:nrow(d0)){
p2 = unique(gsub("\\s+","",strsplit(d0$Reverse.Cites..USC.[i],";")[[1]]))
reverse_citation = c(reverse_citation,length(which(p2 %in% p0)))
p0 = unique(c(p0,p2))
}
d0$reverse_citation = reverse_citation
View(d0)
firms = unique(data$Normalized.Assignee..current.)
years = unique(data$File.Yr)[order(unique(data$File.Yr))]
data = data[order(data$Normalized.Assignee..current., data$File.Yr, decreasing = F),]
df = data.frame(NULL)
for (firm in firms){
d0 = data[data$Normalized.Assignee..current. == firm,]
d0 = d0[order(d0$File.Yr, decreasing = F),]
p0 = unique(gsub("\\s+","",strsplit(paste(d0$Reverse.Cites..USC.[1], collapse = ";"),";")[[1]]))
# for (j in 1:length(years)) {
# d = d0[d0$Normalized.Assignee..current. == firm & d0$File.Yr == years[j],]
reverse_citation = NULL
for (i in 1:nrow(d0)){
p2 = unique(gsub("\\s+","",strsplit(d0$Reverse.Cites..USC.[i],";")[[1]]))
reverse_citation = c(reverse_citation,length(which(p2 %in% p0)))
p0 = unique(c(p0,p2))
}
d0$reverse_citation = reverse_citation
df = rbind(df,d0)
}
View(df)
runApp('D:/30773/Google Drive/MKTR 2016/ShinyApps/Basic text App/basic-text-analysis-shinyapp')
runApp('D:/30773/Google Drive/MKTR 2016/ShinyApps/Basic text App/basic-text-analysis-shinyapp')
runApp('D:/30773/Google Drive/MKTR 2016/ShinyApps/Basic text App v1/basic-text-analysis-shinyapp')
install.packages("fmsb ")
install.packages("fmsb")
install.packages("fmsb")
shiny::runApp()
